{"version":3,"file":"ReactTags.js","sources":["../lib/ReactTags.js"],"sourcesContent":["'use strict'\n\nconst React = require('react')\nconst Tag = require('./Tag')\nconst Input = require('./Input')\nconst Suggestions = require('./Suggestions')\n\nconst KEYS = {\n  ENTER: 13,\n  TAB: 9,\n  BACKSPACE: 8,\n  UP_ARROW: 38,\n  DOWN_ARROW: 40\n}\n\nconst CLASS_NAMES = {\n  root: 'react-tags',\n  selected: 'react-tags__selected',\n  selectedTag: 'react-tags__selected-tag',\n  selectedTagName: 'react-tags__selected-tag-name',\n  search: 'react-tags__search',\n  searchInput: 'react-tags__search-input',\n  suggestions: 'react-tags__suggestions',\n  isActive: 'is-active',\n  isDisabled: 'is-disabled'\n}\n\nclass ReactTags extends React.Component {\n  constructor (props) {\n    super(props)\n\n    this.state = {\n      query: '',\n      focused: false,\n      expandable: false,\n      selectedIndex: -1,\n      classNames: Object.assign({}, CLASS_NAMES, this.props.classNames)\n    }\n  }\n\n  componentWillReceiveProps (newProps) {\n    this.setState({\n      classNames: Object.assign({}, CLASS_NAMES, newProps.classNames)\n    })\n  }\n\n  handleChange (e) {\n    const query = e.target.value\n\n    if (this.props.handleInputChange) {\n      this.props.handleInputChange(query)\n    }\n\n    this.setState({ query })\n  }\n\n  handleKeyDown (e) {\n    const { query, selectedIndex } = this.state\n\n    // when one of the terminating keys is pressed, add current query to the tags.\n    if (e.keyCode === KEYS.ENTER || e.keyCode === KEYS.TAB) {\n      query && e.preventDefault()\n\n      if (query.length >= this.props.minQueryLength) {\n        // Check if the user typed in an existing suggestion.\n        const match = this.suggestions.state.options.findIndex((suggestion) => {\n          return suggestion.name.search(new RegExp(`^${query}$`, 'i')) === 0\n        })\n\n        const index = selectedIndex === -1 ? match : selectedIndex\n\n        if (index > -1) {\n          this.addTag(this.suggestions.state.options[index])\n        } else if (this.props.allowNew) {\n          this.addTag({ name: query })\n        }\n      }\n    }\n\n    // when backspace key is pressed and query is blank, delete the last tag\n    if (e.keyCode === KEYS.BACKSPACE && query.length === 0) {\n      this.deleteTag(this.props.tags.length - 1)\n    }\n\n    if (e.keyCode === KEYS.UP_ARROW) {\n      e.preventDefault()\n\n      // if last item, cycle to the bottom\n      if (selectedIndex <= 0) {\n        this.setState({ selectedIndex: this.suggestions.state.options.length - 1 })\n      } else {\n        this.setState({ selectedIndex: selectedIndex - 1 })\n      }\n    }\n\n    if (e.keyCode === KEYS.DOWN_ARROW) {\n      e.preventDefault()\n\n      this.setState({ selectedIndex: (selectedIndex + 1) % this.suggestions.state.options.length })\n    }\n  }\n\n  handleClick (e) {\n    if (document.activeElement !== e.target) {\n      this.input.input.focus()\n    }\n  }\n\n  handleBlur () {\n    this.setState({ focused: false, selectedIndex: -1 })\n  }\n\n  handleFocus () {\n    this.setState({ focused: true })\n  }\n\n  addTag (tag) {\n    if (tag.disabled) {\n      return\n    }\n\n    this.props.handleAddition(tag)\n\n    // reset the state\n    this.setState({\n      query: '',\n      selectedIndex: -1\n    })\n  }\n\n  deleteTag (i) {\n    this.props.handleDelete(i)\n    this.setState({ query: '' })\n  }\n\n  render () {\n    const listboxId = 'ReactTags-listbox'\n\n    const tags = this.props.tags.map((tag, i) => (\n      <Tag\n        key={i}\n        tag={tag}\n        classNames={this.state.classNames}\n        onDelete={this.deleteTag.bind(this, i)} />\n    ))\n\n    const expandable = this.state.focused && this.state.query.length >= this.props.minQueryLength\n\n    return (\n      <div className={this.state.classNames.root} onClick={this.handleClick.bind(this)}>\n        <div className={this.state.classNames.selected} aria-live='polite' aria-relevant='additions removals'>\n          {tags}\n        </div>\n        <div\n          className={this.state.classNames.search}\n          onBlur={this.handleBlur.bind(this)}\n          onFocus={this.handleFocus.bind(this)}\n          onChange={this.handleChange.bind(this)}\n          onKeyDown={this.handleKeyDown.bind(this)}>\n          <Input {...this.state}\n            ref={(c) => { this.input = c }}\n            listboxId={listboxId}\n            autofocus={this.props.autofocus}\n            autoresize={this.props.autoresize}\n            expandable={expandable}\n            placeholder={this.props.placeholder} />\n          <Suggestions {...this.state}\n            ref={(c) => { this.suggestions = c }}\n            listboxId={listboxId}\n            expandable={expandable}\n            suggestions={this.props.suggestions}\n            addTag={this.addTag.bind(this)} />\n        </div>\n      </div>\n    )\n  }\n}\n\nReactTags.defaultProps = {\n  tags: [],\n  placeholder: 'Add new tag',\n  suggestions: [],\n  autofocus: true,\n  autoresize: true,\n  minQueryLength: 2,\n  maxSuggestionsLength: 6,\n  allowNew: false\n}\n\nReactTags.propTypes = {\n  tags: React.PropTypes.array,\n  placeholder: React.PropTypes.string,\n  suggestions: React.PropTypes.array,\n  autofocus: React.PropTypes.bool,\n  autoresize: React.PropTypes.bool,\n  handleDelete: React.PropTypes.func.isRequired,\n  handleAddition: React.PropTypes.func.isRequired,\n  handleInputChange: React.PropTypes.func,\n  minQueryLength: React.PropTypes.number,\n  maxSuggestionsLength: React.PropTypes.number,\n  classNames: React.PropTypes.object,\n  allowNew: React.PropTypes.bool\n}\n\nmodule.exports = ReactTags\n"],"names":["const","super","this"],"mappings":"AAAA,YAAY;;AAEZA,GAAK,CAAC,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC;AAC9BA,GAAK,CAAC,GAAG,GAAG,OAAO,CAAC,OAAO,CAAC;AAC5BA,GAAK,CAAC,KAAK,GAAG,OAAO,CAAC,SAAS,CAAC;AAChCA,GAAK,CAAC,WAAW,GAAG,OAAO,CAAC,eAAe,CAAC;;AAE5CA,GAAK,CAAC,IAAI,GAAG;EACX,KAAK,EAAE,EAAE;EACT,GAAG,EAAE,CAAC;EACN,SAAS,EAAE,CAAC;EACZ,QAAQ,EAAE,EAAE;EACZ,UAAU,EAAE,EAAE;CACf;;AAEDA,GAAK,CAAC,WAAW,GAAG;EAClB,IAAI,EAAE,YAAY;EAClB,QAAQ,EAAE,sBAAsB;EAChC,WAAW,EAAE,0BAA0B;EACvC,eAAe,EAAE,+BAA+B;EAChD,MAAM,EAAE,oBAAoB;EAC5B,WAAW,EAAE,0BAA0B;EACvC,WAAW,EAAE,yBAAyB;EACtC,QAAQ,EAAE,WAAW;EACrB,UAAU,EAAE,aAAa;CAC1B;;AAED,IAAM,SAAS,GAAwB;EAAC,AACtC,kBAAW,CAAC,CAAC,KAAK,EAAE;IAClBC,UAAK,KAAA,CAAC,MAAA,KAAK,CAAC;;IAEZ,IAAI,CAAC,KAAK,GAAG;MACX,KAAK,EAAE,EAAE;MACT,OAAO,EAAE,KAAK;MACd,UAAU,EAAE,KAAK;MACjB,aAAa,EAAE,CAAC,CAAC;MACjB,UAAU,EAAE,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,WAAW,EAAE,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC;KAClE;GACF;;;;8CAAA;;EAED,oBAAA,yBAAyB,AAAC,sCAAA,CAAC,QAAQ,EAAE;IACnC,IAAI,CAAC,QAAQ,CAAC;MACZ,UAAU,EAAE,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,WAAW,EAAE,QAAQ,CAAC,UAAU,CAAC;KAChE,CAAC;GACH,CAAA;;EAED,oBAAA,YAAY,AAAC,yBAAA,CAAC,CAAC,EAAE;IACfD,GAAK,CAAC,KAAK,GAAG,CAAC,CAAC,MAAM,CAAC,KAAK;;IAE5B,IAAI,IAAI,CAAC,KAAK,CAAC,iBAAiB,EAAE;MAChC,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,KAAK,CAAC;KACpC;;IAED,IAAI,CAAC,QAAQ,CAAC,EAAE,OAAA,KAAK,EAAE,CAAC;GACzB,CAAA;;EAED,oBAAA,aAAa,AAAC,0BAAA,CAAC,CAAC,EAAE;IAChB,AAAK,AAAyB,OAAA,GAAG,IAAI,CAAC,KAAK;IAAnC,IAAA,KAAK;IAAE,IAAA,aAAa,qBAAtB,AAAO,AAAe,AAAe;;;IAG3C,IAAI,CAAC,CAAC,OAAO,KAAK,IAAI,CAAC,KAAK,IAAI,CAAC,CAAC,OAAO,KAAK,IAAI,CAAC,GAAG,EAAE;MACtD,KAAK,IAAI,CAAC,CAAC,cAAc,EAAE;;MAE3B,IAAI,KAAK,CAAC,MAAM,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE;;QAE7CA,GAAK,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,SAAA,CAAC,UAAU,EAAE,AAAG;UACrE,OAAO,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,MAAM,CAAC,CAAA,GAAE,GAAE,KAAK,MAAE,CAAC,EAAE,GAAG,CAAC,CAAC,KAAK,CAAC;SACnE,CAAC;;QAEFA,GAAK,CAAC,KAAK,GAAG,aAAa,KAAK,CAAC,CAAC,GAAG,KAAK,GAAG,aAAa;;QAE1D,IAAI,KAAK,GAAG,CAAC,CAAC,EAAE;UACd,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;SACnD,MAAM,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;UAC9B,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;SAC7B;OACF;KACF;;;IAGD,IAAI,CAAC,CAAC,OAAO,KAAK,IAAI,CAAC,SAAS,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;MACtD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;KAC3C;;IAED,IAAI,CAAC,CAAC,OAAO,KAAK,IAAI,CAAC,QAAQ,EAAE;MAC/B,CAAC,CAAC,cAAc,EAAE;;;MAGlB,IAAI,aAAa,IAAI,CAAC,EAAE;QACtB,IAAI,CAAC,QAAQ,CAAC,EAAE,aAAa,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;OAC5E,MAAM;QACL,IAAI,CAAC,QAAQ,CAAC,EAAE,aAAa,EAAE,aAAa,GAAG,CAAC,EAAE,CAAC;OACpD;KACF;;IAED,IAAI,CAAC,CAAC,OAAO,KAAK,IAAI,CAAC,UAAU,EAAE;MACjC,CAAC,CAAC,cAAc,EAAE;;MAElB,IAAI,CAAC,QAAQ,CAAC,EAAE,aAAa,EAAE,CAAC,aAAa,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;KAC9F;GACF,CAAA;;EAED,oBAAA,WAAW,AAAC,wBAAA,CAAC,CAAC,EAAE;IACd,IAAI,QAAQ,CAAC,aAAa,KAAK,CAAC,CAAC,MAAM,EAAE;MACvC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,EAAE;KACzB;GACF,CAAA;;EAED,oBAAA,UAAU,AAAC,uBAAA,GAAG;IACZ,IAAI,CAAC,QAAQ,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,aAAa,EAAE,CAAC,CAAC,EAAE,CAAC;GACrD,CAAA;;EAED,oBAAA,WAAW,AAAC,wBAAA,GAAG;IACb,IAAI,CAAC,QAAQ,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;GACjC,CAAA;;EAED,oBAAA,MAAM,AAAC,mBAAA,CAAC,GAAG,EAAE;IACX,IAAI,GAAG,CAAC,QAAQ,EAAE;MAChB,MAAM;KACP;;IAED,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,GAAG,CAAC;;;IAG9B,IAAI,CAAC,QAAQ,CAAC;MACZ,KAAK,EAAE,EAAE;MACT,aAAa,EAAE,CAAC,CAAC;KAClB,CAAC;GACH,CAAA;;EAED,oBAAA,SAAS,AAAC,sBAAA,CAAC,CAAC,EAAE;IACZ,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC,CAAC;IAC1B,IAAI,CAAC,QAAQ,CAAC,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC;GAC7B,CAAA;;EAED,oBAAA,MAAM,AAAC,mBAAA,GAAG,CAAC;;AAAA;IACTA,GAAK,CAAC,SAAS,GAAG,mBAAmB;;IAErCA,GAAK,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,SAAA,CAAC,GAAG,EAAE,CAAC,EAAE,AAAG,SAAA;MAC3C,qBAAC,GAAG,GAAA;QACF,GAAG,EAAC,AAAC,CAAC,AAAC,EACP,GAAG,EAAC,AAAC,GAAG,AAAC,EACT,UAAU,EAAC,AAACE,MAAI,CAAC,KAAK,CAAC,UAAU,AAAC,EAClC,QAAQ,EAAC,AAACA,MAAI,CAAC,SAAS,CAAC,IAAI,CAACA,MAAI,EAAE,CAAC,CAAC,AAAC,EAAA,CAAG;KAC7C,GAAA,CAAC;;IAEFF,GAAK,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc;;IAE7F,OAAO;MACL,qBAAC,CAAA,GAAG,IAAA,CAAC,SAAS,EAAC,AAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,IAAI,AAAC,EAAC,OAAO,EAAC,AAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,AAAC,EAAA,AAAC,CAAA;QAChF,qBAAC,CAAA,GAAG,IAAA,CAAC,SAAS,EAAC,AAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,AAAC,EAAC,WAAS,EAAC,QAAQ,EAAC,eAAa,EAAC,oBAAoB,EAAA,AAAC,CAAA;UACpG,AAAC,IAAI,AAAC;QACR,CAAM,CAAA;QACN,qBAAC,CAAA,GAAG,IAAA;UACF,SAAS,EAAC,AAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,MAAM,AAAC,EACxC,MAAM,EAAC,AAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,AAAC,EACnC,OAAO,EAAC,AAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,AAAC,EACrC,QAAQ,EAAC,AAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,AAAC,EACvC,SAAS,EAAC,AAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,AAAC,EAAA,AAAC,CAAA;UAC1C,qBAAC,KAAK,mBAAA,CAAC,AAAI,IAAI,CAAC,KAAK,AAAC,EACpB,EAAA,GAAG,EAAC,AAAC,SAAA,CAAC,CAAC,EAAE,AAAG,EAAEE,MAAI,CAAC,KAAK,GAAG,CAAC,EAAE,AAAC,EAC/B,SAAS,EAAC,AAAC,SAAS,AAAC,EACrB,SAAS,EAAC,AAAC,IAAI,CAAC,KAAK,CAAC,SAAS,AAAC,EAChC,UAAU,EAAC,AAAC,IAAI,CAAC,KAAK,CAAC,UAAU,AAAC,EAClC,UAAU,EAAC,AAAC,UAAU,AAAC,EACvB,WAAW,EAAC,AAAC,IAAI,CAAC,KAAK,CAAC,WAAW,AAAC,GAAA,CAAG,CAAA;UACzC,qBAAC,WAAW,mBAAA,CAAC,AAAI,IAAI,CAAC,KAAK,AAAC,EAC1B,EAAA,GAAG,EAAC,AAAC,SAAA,CAAC,CAAC,EAAE,AAAG,EAAEA,MAAI,CAAC,WAAW,GAAG,CAAC,EAAE,AAAC,EACrC,SAAS,EAAC,AAAC,SAAS,AAAC,EACrB,UAAU,EAAC,AAAC,UAAU,AAAC,EACvB,WAAW,EAAC,AAAC,IAAI,CAAC,KAAK,CAAC,WAAW,AAAC,EACpC,MAAM,EAAC,AAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,AAAC,GAAA,CAAG;QACtC,CAAM;MACR,CAAM;KACP;GACF,CAAA,AACF;;;EArJuB,KAAK,CAAC,SAqJ7B,GAAA;;AAED,SAAS,CAAC,YAAY,GAAG;EACvB,IAAI,EAAE,EAAE;EACR,WAAW,EAAE,aAAa;EAC1B,WAAW,EAAE,EAAE;EACf,SAAS,EAAE,IAAI;EACf,UAAU,EAAE,IAAI;EAChB,cAAc,EAAE,CAAC;EACjB,oBAAoB,EAAE,CAAC;EACvB,QAAQ,EAAE,KAAK;CAChB;;AAED,SAAS,CAAC,SAAS,GAAG;EACpB,IAAI,EAAE,KAAK,CAAC,SAAS,CAAC,KAAK;EAC3B,WAAW,EAAE,KAAK,CAAC,SAAS,CAAC,MAAM;EACnC,WAAW,EAAE,KAAK,CAAC,SAAS,CAAC,KAAK;EAClC,SAAS,EAAE,KAAK,CAAC,SAAS,CAAC,IAAI;EAC/B,UAAU,EAAE,KAAK,CAAC,SAAS,CAAC,IAAI;EAChC,YAAY,EAAE,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU;EAC7C,cAAc,EAAE,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU;EAC/C,iBAAiB,EAAE,KAAK,CAAC,SAAS,CAAC,IAAI;EACvC,cAAc,EAAE,KAAK,CAAC,SAAS,CAAC,MAAM;EACtC,oBAAoB,EAAE,KAAK,CAAC,SAAS,CAAC,MAAM;EAC5C,UAAU,EAAE,KAAK,CAAC,SAAS,CAAC,MAAM;EAClC,QAAQ,EAAE,KAAK,CAAC,SAAS,CAAC,IAAI;CAC/B;;AAED,MAAM,CAAC,OAAO,GAAG,SAAS;"}